# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Описание архитектуры

Приложение основано на событийно-ориентированной архитектуре, включает в себя слой данных (Model), слой отображения (View) и брокер событий Event Emitter в своей классической реализации. Слои данных и представления не могут быть связаны друг с другом непосредственно и осуществляют взаимодействие посредством генерацией событий через общий экземпляр брокера событий, к которым привязаны соответствующие обработчики событий

### Брокер событий:

Базовый класс EventEmitter позволяет генерировать кастомные события и осуществлять подписку на эти события с помощью метода on, передавая в него коллбеки-обработчики события. Данные обработчики вызываются впоследствии при вызове метода emit, запускающего событие. Конструкторы всех классов отображения и моделей принимают общий экземпляр класса EventEmitter для последующей реализации событийно-ориентированной архитектуры

## Модели:

### StoreModel 

класс StoreModel хранит массив объектов с данными о товарах каталога, добавляет их и получает (массив целиком или отдельный товар по id). Добавление новых товаров генерирует событие 'store: changed'

### BasketModel

Класс BasketModel, хранит массив id товаров, добавляет и удаляет id из массива, выдает количество добавленных товаров, содержит метод для очистки всех товаров из корзины

### OrderModel

Класс OrderModel содержит сеттеры для свойств, из которых впоследствии формируется объект данных заказа

## Отображение:

### Page

Класс Page, устанавливает элемент счётчика корзины, а также кнопку корзины, навешивает обработчик на кнопку корзины, который генерирует у страницы событие 'OpenBacketBtn: clicked', получает и устанавливает элемент галереи, выводит её на страницу

### Modal

Класс Modal, содержит методы открытия и закрытия модального окна, установки отображаемого в модальном окне контента. Вешает обработчик на кнопку закрытия, который генерирует событие 'modal: close' по клику

### Card

Класс Card создаёт экземпляр карточки товара на основе полученного объекта данных товара, хранит id товара. Способен принимать разные темплейты (В приложении задействовано 3: карточка каталога, карточка с описанием, миниатюрная карточка для отображения в корзине), старается найти в темплейте и заполнить данными объекта товара максимальное количество возможных элементов с помощью сеттеров. Сеттеры проверяют существование в шаблоне того или иного элемента отображения. Кроме этого, в карточку можно передать опциональный булевый параметр isPicked, который устанавливается в true если товар из карточки уже содержится в корзине.

### ItemPreview

Класс ItemPreview рендерит контент для модального окна (превью для выбранной карточки товара). Кнопка "В корзину" при клике генерирует событие 'basketItem: added'

### BasketView

Класс BasketView, рендерит содержимое модального окна при открытии корзины, служит контейнером для экземпляров класса Card, которые отображают добавленные в корзину товары, получает общую стоимость товаров в корзине и отображает её. Кроме того, отслеживает количество товаров в корзине, если товаров нет -  отображает элемент с соответствующим сообщением. Вызывает событие 'basket: proceed' по нажатию кнопки "Оформить".

### OrderForm

Класс создаёт форму оформления заказа, которая принимает способ оплаты, а также адрес доставки для передачи этих данных в модель создаваемого заказа. Содержит методы для рендера формы в модальном окне, а также для очистки полей формы. На кнопку "Далее" при рендере вешается обработчик клика, который вызывает событие 'order: proceed' 

### ContactForm

Класс создаёт форму оформления заказа, отображаемую в модальном окне, принимает электронную почту, а также телефон покупателя для передачи этих данных в модель создаваемого заказа. На кнопке "Оплатить" вешается обработчик клика, который заполняет поля mail и phone данными из соответствующих инпутов для последующей передачи в модель заказа и вызывает событие 'contactForm: submit'

### SuccessView

Класс рендерит контент для модального окна при успешном оформлении заказа, отображает общую сумму заказа из объекта, который возвращает сервер. Вешает на кнопку 'За новыми покупками!' обработчик клика, который генерирует событие 'modal: close'.






